CAIRO (Reuters) - Militants killed more than 230 people at a mosque in Egypt's North Sinai on Friday, detonating a bomb and gunning down worshippers in the deadliest attack in the country's modern history, state media and witnesses said. No group immediately claimed responsibility, but since 2013 Egyptian security forces have battled a stubborn Islamic State affiliate in the mainly desert region, and militants have killed hundreds of police and soldiers. State media showed images of bloodied victims and bodies covered in blankets inside the Al Rawdah mosque in Bir al-Abed, west of El Arish, the main city in North Sinai. Worshippers were finishing Friday prayers at the mosque when a bomb exploded, witnesses said. Around 40 gunmen set up positions outside the mosque with jeeps and opened fire from different directions as people tried to escape, witnesses said. "They were shooting at people as they left the mosque," said a local resident whose relatives were at the scene. "They were shooting at the ambulances too." The public prosecutors' office said in a statement 235 people had been killed and 109 more wounded. Striking at a mosque would be a change in tactics for the Sinai militants, who have usually attacked troops and police and Christian churches. Arabiya news channel and some local sources said some of the worshippers were Sufis, whom groups such as Islamic State consider targets because they revere saints and shrines, which for Islamists is tantamount to idolatry. The jihadists have also attacked local tribes and their militias for working with the army and police, branding them traitors. The Sinai branch is one of Islamic State's surviving branches following the collapse of its self-declared caliphate in Syria and Iraq after military defeats by U.S.-backed forces. President Abdel Fattah al-Sisi, a former armed forces commander who presents himself as a bulwark against Islamist militancy, convened an emergency meeting with his defence and interior ministers and intelligence chief soon after the attack, the presidency and state television said. Security has long been one of the key sources of public support for the former general, who is expected to run for re-election early next year for another four-year term. He promised the attack "would not go unpunished". "Justice will be served against all those who participated, contributed, supported, funded, or instigated this cowardly attack," Sisi said in a statement. U.S. President Donald Trump, in a post on Twitter on Friday, called the assault a "horrible and cowardly terrorist attack". "The world cannot tolerate terrorism, we must defeat them militarily and discredit the extremist ideology that forms the basis of their existence," he added. French Foreign Minister Jean-Yves Le Drian also condemned the attack and said Paris stood with its ally. North Sinai, which stretches from the Suez Canal eastwards to the Gaza Strip and Israel, has long been a security headache for Egyptian security forces because of smuggling. Sisi has support from some Bedouin tribal leaders, who have helped the army locate weapon-smuggling routes used by jihadi groups, security officials said. Local militant group Ansar Bayt al-Maqdis, once allied to al Qaeda, split from it and declared allegiance to Islamic State in 2013. Bloodshed in the Sinai worsened after 2013 when Sisi led the overthrow of President Mohamed Mursi of the Muslim Brotherhood. Islamic State earlier this year posted a video of the beheading of two Sufis in northern Sinai, accusing them of practicing "sorcery". In July this year, at least 23 soldiers were killed when suicide car bombs hit two military checkpoints in the Sinai, in an attack claimed by Islamic State. Militants have tried to expand their operations into Egypt's heavily populated mainland, hitting Coptic Christian churches and pilgrims. In May, gunmen attacked a Coptic group travelling to a monastery in southern Egypt, killing 29. Additional reporting by Mohamed Abdellah in Cairo and Yousri Mohamed in Ismalia; Editing by Andrew Roche